import{$,B as h,F as B,G as V,I as N,J as G,K as H,L as W,M as Z,O as z,Q as _,R as w,S as Y,T as K,U as q,V as J,W as E,X as Q,Y as I,Z as X,a as O,aa as ee,b as P,c as m,d as f,da as te,e as R,f as T,fa as ie,g as y,ga as ne,h as U,i as l,ia as oe,j as g,ja as A,k as S,l as j,m as d,r as o,s as i,t as u,u as D,v as b,w as C,x as a,z as k}from"./chunk-JSQJYU6R.js";import"./chunk-TLJKL643.js";import{i as s,j as c}from"./chunk-JTLGJ2MS.js";s();s();s();var F=new P("Authentication redirect url"),x=(()=>{let e=class e{constructor(){this.supabaseClient=m(E),this.sessionStore=m(I),this.authenticationRedirectUrl=m(F),this.isSessionInitialised=g(!1)}initialiseSession(){return this.supabaseClient.auth.getSession().then(({data:r})=>{r.session!==null&&(this.isSessionInitialised.set(!0),this.sessionStore.setSession(r.session))})}monitorAuthChanges(){this.supabaseClient.auth.onAuthStateChange(r=>{r==="SIGNED_OUT"&&this.isSessionInitialised.set(!1)})}signIn(r){return console.log(this.authenticationRedirectUrl),this.supabaseClient.auth.signInWithOtp({email:r,options:{emailRedirectTo:this.authenticationRedirectUrl}})}signOut(){return this.supabaseClient.auth.signOut()}};e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=O({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();s();function L(t){return()=>t.initialiseSession()}s();s();var re=(()=>{let e=class e{constructor(){this.sessionStore=m(I),this.email=g(void 0);let{user:r}=this.sessionStore.getSession();this.email.set(r.email)}};e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=f({type:e,selectors:[["propertea-account"]],standalone:!0,features:[h],decls:2,vars:1,template:function(n,p){n&1&&(o(0,"p"),a(1),i()),n&2&&(l(),k("",p.email(),`
`))},dependencies:[A],encapsulation:2,changeDetection:0});let t=e;return t})();s();var ae=(()=>{let e=class e{constructor(){this.sessionService=m(x),this.formBuilder=m(oe),this.router=m(_),this.loading=g(!1),this.signInForm=this.formBuilder.group({email:""})}ngOnInit(){this.sessionService.isSessionInitialised()&&this.router.navigateByUrl("/")}async onSubmit(){try{this.loading.set(!0);let r=this.signInForm.value.email,{error:n}=await this.sessionService.signIn(r);if(n)throw n;alert("Check your email for the login link!")}catch(r){r instanceof Error&&alert(r.message)}finally{this.signInForm.reset(),this.loading.set(!1)}}};e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=f({type:e,selectors:[["propertea-login"]],standalone:!0,features:[h],decls:14,vars:3,consts:[[1,"row","flex-center","flex"],["aria-live","polite",1,"col-6","form-widget"],[1,"header"],[1,"description"],[1,"form-widget",3,"ngSubmit","formGroup"],["for","email"],["id","email","formControlName","email","type","email","placeholder","Your email","autocomplete","email",1,"inputField"],["type","submit",1,"btn","block",3,"disabled"]],template:function(n,p){n&1&&(o(0,"div",0)(1,"div",1)(2,"h1",2),a(3,"Supabase + Angular"),i(),o(4,"p",3),a(5,"Sign in via magic link with your email below"),i(),o(6,"form",4),b("ngSubmit",function(){return p.onSubmit()}),o(7,"div")(8,"label",5),a(9,"Email"),i(),u(10,"input",6),i(),o(11,"div")(12,"button",7),a(13),i()()()()()),n&2&&(l(6),d("formGroup",p.signInForm),l(6),d("disabled",p.loading()),l(),k(" ",p.loading()?"Loading":"Send magic link"," "))},dependencies:[A,te,X,$,ee,ie,ne],encapsulation:2,changeDetection:0});let t=e;return t})();s();var se=(()=>{let e=class e{};e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=f({type:e,selectors:[["propertea-dashboard"]],standalone:!0,features:[h],decls:3,vars:0,consts:[["routerLink","/properties"]],template:function(n,p){n&1&&(a(0,"Dashboard "),o(1,"a",0),a(2,"Go to property list"),i())},dependencies:[w],encapsulation:2,changeDetection:0});let t=e;return t})();var ce=[{path:"",pathMatch:"full",redirectTo:"dashboard"},{path:"dashboard",component:se},{path:"login",component:ae},{path:"account",component:re},{path:"properties",loadChildren:()=>import("./chunk-TW4DMT77.js")}],le=ce;var pe={providers:[K(le,q()),H(W()),V(),{provide:E,useFactory:()=>Q(c.PROPERTEA_SUPABASE_URL,c.PROPERTEA_SUPABASE_KEY)},{provide:F,useFactory:()=>c.PROPERTEA_AUTH_REDIRECT_URL},{provide:B,useFactory:L,multi:!0,deps:[x]}]};s();function de(t,e){t&1&&(y(),o(0,"svg",16),u(1,"path",17),i())}function ue(t,e){t&1&&(y(),o(0,"svg",16),u(1,"path",18),i())}function fe(t,e){if(t&1){let v=D();o(0,"div",11)(1,"button",12),b("click",function(){R(v);let n=C();return T(n.mainMenuOpen=!n.mainMenuOpen)}),u(2,"span",13),o(3,"span",14),a(4,"Open main menu"),i(),S(5,de,2,0,"svg",15)(6,ue,2,0,"svg",15),i()()}if(t&2){let v=C();l(),j("aria-expanded",v.mainMenuOpen),l(4),d("ngIf",!v.mainMenuOpen),l(),d("ngIf",v.mainMenuOpen)}}function he(t,e){t&1&&(o(0,"div",19)(1,"div",20)(2,"a",21),a(3," Dashboard "),i(),o(4,"a",22),a(5," My Properties "),i()()())}function ve(t,e){if(t&1){let v=D();o(0,"div",23)(1,"div",24)(2,"button",25)(3,"span",14),a(4,"Open user menu"),i(),y(),o(5,"svg",26),u(6,"path",27),i()(),U(),o(7,"ul",28)(8,"li")(9,"a",29),a(10,"Your Profile"),i()(),o(11,"li")(12,"a"),a(13,"Settings"),i()(),o(14,"li")(15,"button",30),b("click",function(){R(v);let n=C();return T(n.logOut())}),a(16,"Sign out"),i()()()()()}}function ge(t,e){t&1&&(o(0,"div",31)(1,"div",32)(2,"a",33),a(3," Dashboard "),i(),o(4,"a",34),a(5," My Properties "),i()()())}var me=(()=>{let e=class e{constructor(){this.sessionService=m(x),this.router=m(_),this.mainMenuOpen=!1,this.isSessionInitialised=this.sessionService.isSessionInitialised,this.sessionService.monitorAuthChanges(),N(()=>{this.isSessionInitialised()||this.router.navigateByUrl("/login")})}async logOut(){await this.sessionService.signOut()}};e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=f({type:e,selectors:[["propertea-root"]],standalone:!0,features:[h],decls:13,vars:4,consts:[[1,"bg-gray-800"],[1,"navbar","mx-auto","max-w-7xl","px-2","sm:px-6","lg:px-8"],["class","inset-y-0 left-0 flex items-center sm:hidden",4,"ngIf"],[1,"flex","flex-1","items-center","justify-center","sm:items-stretch","sm:justify-start"],[1,"flex","flex-shrink-0","items-center"],["routerLink","/"],["src","https://tailwindui.com/img/logos/mark.svg?color=indigo&shade=500","alt","ProperTea logo",1,"h-8","w-auto"],["class","hidden sm:ml-6 sm:block",4,"ngIf"],["class","flex-none",4,"ngIf"],["class","sm:hidden","id","mobile-menu",4,"ngIf"],[1,"mx-auto","max-w-7xl","px-2","sm:px-6","lg:px-8","pt-2","sm:pt-6","lg:pt-8"],[1,"inset-y-0","left-0","flex","items-center","sm:hidden"],["type","button","aria-controls","mobile-menu",1,"btn","btn-circle",3,"click"],[1,"absolute","-inset-0.5"],[1,"sr-only"],["class","h-6 w-6","fill","none","viewBox","0 0 24 24","stroke-width","1.5","stroke","currentColor","aria-hidden","true",4,"ngIf"],["fill","none","viewBox","0 0 24 24","stroke-width","1.5","stroke","currentColor","aria-hidden","true",1,"h-6","w-6"],["stroke-linecap","round","stroke-linejoin","round","d","M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"],["stroke-linecap","round","stroke-linejoin","round","d","M6 18L18 6M6 6l12 12"],[1,"hidden","sm:ml-6","sm:block"],[1,"flex","space-x-4"],["routerLink","/dashboard","routerLinkActive","active-link","ariaCurrentWhenActive","page",1,"navbar-link","rounded-md","px-3","py-2","text-sm","font-medium"],["routerLink","/properties","routerLinkActive","active-link","ariaCurrentWhenActive","page",1,"navbar-link","rounded-md","px-3","py-2","text-sm","font-medium"],[1,"flex-none"],[1,"dropdown","dropdown-end"],["tabindex","0","aria-expanded","false","aria-haspopup","true",1,"btn","btn-circle","avatar"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke-width","1.5","stroke","currentColor",1,"h-8","w-8","text-white"],["stroke-linecap","round","stroke-linejoin","round","d","M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z"],["role","menu","aria-orientation","vertical","aria-labelledby","user-menu-button","tabindex","0",1,"menu","dropdown-content","mt-3","z-[1]","p-2","shadow","bg-base-100","rounded-box","w-52"],["routerLink","/account"],["type","button",3,"click"],["id","mobile-menu",1,"sm:hidden"],[1,"space-y-1","px-2","pb-3","pt-2"],["routerLink","/dashboard","routerLinkActive","active-link","ariaCurrentWhenActive","page",1,"navbar-link","block","rounded-md","px-3","py-2","text-base","font-medium"],["routerLink","/properties","routerLinkActive","active-link","ariaCurrentWhenActive","page",1,"navbar-link","block","rounded-md","px-3","py-2","text-base","font-medium"]],template:function(n,p){n&1&&(o(0,"header")(1,"nav",0)(2,"div",1),S(3,fe,7,3,"div",2),o(4,"div",3)(5,"div",4)(6,"a",5),u(7,"img",6),i()(),S(8,he,6,0,"div",7),i(),S(9,ve,17,0,"div",8),i(),S(10,ge,6,0,"div",9),i()(),o(11,"div",10),u(12,"router-outlet"),i()),n&2&&(l(3),d("ngIf",p.isSessionInitialised()),l(5),d("ngIf",p.isSessionInitialised()),l(),d("ngIf",p.isSessionInitialised()),l(),d("ngIf",p.mainMenuOpen&&p.isSessionInitialised()))},dependencies:[J,z,w,Y,G],styles:[".navbar-link.active-link[_ngcontent-%COMP%]{--tw-bg-opacity: 1;background-color:rgb(17 24 39 / var(--tw-bg-opacity));--tw-text-opacity: 1;color:rgb(255 255 255 / var(--tw-text-opacity))}.navbar-link[_ngcontent-%COMP%]:not(.active-link){--tw-text-opacity: 1;color:rgb(209 213 219 / var(--tw-text-opacity))}.navbar-link[_ngcontent-%COMP%]:not(.active-link):hover{--tw-bg-opacity: 1;background-color:rgb(55 65 81 / var(--tw-bg-opacity));--tw-text-opacity: 1;color:rgb(255 255 255 / var(--tw-text-opacity))}"]});let t=e;return t})();Z(me,pe).catch(t=>console.error(t));
