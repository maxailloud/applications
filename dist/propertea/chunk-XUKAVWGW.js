import{$ as nt,A as ye,B as Ct,C as me,D as tr,G as Tt,M as Ne,O as rr,P as $e,Q as we,V as tt,X as ir,Y as rt,Z as be,_ as it,a as fe,aa as ot,b as E,ba as Se,c as he,ca as st,d as We,da as nr,e as Ge,ea as at,f as K,fa as lt,g as G,ga as ut,h as x,i as X,ia as ct,j as le,k as ue,l as J,m as Pt,n as ne,o as Ze,p as Ye,q as f,r as h,s as T,t as Xe,u as oe,v as ge,w as v,x as ce,y as re,z as et}from"./chunk-FTJ3PC6K.js";import"./chunk-XRMIWS4M.js";import{a as W,b as ae,c as er,i as a}from"./chunk-TZTTFN7K.js";a();a();a();a();a();a();a();var c=Symbol.for("drizzle:entityKind"),mn=Symbol.for("drizzle:hasOwnEntityKind");function d(t,i){if(!t||typeof t!="object")return!1;if(t instanceof i)return!0;if(!Object.prototype.hasOwnProperty.call(i,c))throw new Error(`Class "${i.name??"<unknown>"}" doesn't look like a Drizzle entity. If this is incorrect and the class is provided by Drizzle, please report this as a bug.`);let e=t.constructor;if(e)for(;e;){if(c in e&&e[c]===i[c])return!0;e=Object.getPrototypeOf(e)}return!1}var O=(()=>{class t{constructor(e,r){this.table=e,this.config=r,this.name=r.name,this.notNull=r.notNull,this.default=r.default,this.defaultFn=r.defaultFn,this.onUpdateFn=r.onUpdateFn,this.hasDefault=r.hasDefault,this.primary=r.primaryKey,this.isUnique=r.isUnique,this.uniqueName=r.uniqueName,this.uniqueType=r.uniqueType,this.dataType=r.dataType,this.columnType=r.columnType}static[c]="Column";name;primary;notNull;default;defaultFn;onUpdateFn;hasDefault;isUnique;uniqueName;uniqueType;dataType;columnType;enumValues=void 0;config;mapFromDriverValue(e){return e}mapToDriverValue(e){return e}}return t})();a();a();a();a();var or=(()=>{class t{static[c]="ColumnBuilder";config;constructor(e,r,n){this.config={name:e,notNull:!1,default:void 0,hasDefault:!1,primaryKey:!1,isUnique:!1,uniqueName:void 0,uniqueType:void 0,dataType:r,columnType:n}}$type(){return this}notNull(){return this.config.notNull=!0,this}default(e){return this.config.default=e,this.config.hasDefault=!0,this}$defaultFn(e){return this.config.defaultFn=e,this.config.hasDefault=!0,this}$default=this.$defaultFn;$onUpdateFn(e){return this.config.onUpdateFn=e,this.config.hasDefault=!0,this}$onUpdate=this.$onUpdateFn;primaryKey(){return this.config.primaryKey=!0,this.config.notNull=!0,this}}return t})();a();a();a();var mt=Symbol.for("drizzle:Name"),Nt=Symbol.for("drizzle:Schema"),sr=Symbol.for("drizzle:Columns"),ar=Symbol.for("drizzle:ExtraConfigColumns"),$t=Symbol.for("drizzle:OriginalName"),Et=Symbol.for("drizzle:BaseName"),lr=Symbol.for("drizzle:IsAlias"),ur=Symbol.for("drizzle:ExtraConfigBuilder"),hi=Symbol.for("drizzle:IsDrizzleTable"),y=(()=>{class t{static[c]="Table";static Symbol={Name:mt,Schema:Nt,OriginalName:$t,Columns:sr,ExtraConfigColumns:ar,BaseName:Et,IsAlias:lr,ExtraConfigBuilder:ur};[mt];[$t];[Nt];[sr];[ar];[Et];[lr]=!1;[ur]=void 0;[hi]=!0;constructor(e,r,n){this[mt]=this[$t]=e,this[Nt]=r,this[Et]=n}}return t})();function Ee(t){return t[mt]}var Bt=Symbol.for("drizzle:PgInlineForeignKeys"),H=class extends y{static[c]="PgTable";static Symbol=Object.assign({},y.Symbol,{InlineForeignKeys:Bt});[Bt]=[];[y.Symbol.ExtraConfigBuilder]=void 0};function qt(t,i,e,r,n=t){let o=new H(t,r,n),u=Object.fromEntries(Object.entries(i).map(([S,p])=>{let b=p,P=b.build(o);return o[Bt].push(...b.buildForeignKeys(P,o)),[S,P]})),l=Object.fromEntries(Object.entries(i).map(([S,p])=>{let P=p.buildExtraConfigColumn(o);return[S,P]})),m=Object.assign(o,u);return m[y.Symbol.Columns]=u,m[y.Symbol.ExtraConfigColumns]=l,e&&(m[H.Symbol.ExtraConfigBuilder]=e),m}var Be=(t,i,e)=>qt(t,i,e,void 0);var cr=(()=>{class t{static[c]="PgForeignKeyBuilder";reference;_onUpdate="no action";_onDelete="no action";constructor(e,r){this.reference=()=>{let{name:n,columns:o,foreignColumns:u}=e();return{name:n,columns:o,foreignTable:u[0].table,foreignColumns:u}},r&&(this._onUpdate=r.onUpdate,this._onDelete=r.onDelete)}onUpdate(e){return this._onUpdate=e===void 0?"no action":e,this}onDelete(e){return this._onDelete=e===void 0?"no action":e,this}build(e){return new gi(e,this)}}return t})(),gi=(()=>{class t{constructor(e,r){this.table=e,this.reference=r.reference,this.onUpdate=r._onUpdate,this.onDelete=r._onDelete}static[c]="PgForeignKey";reference;onUpdate;onDelete;getName(){let{name:e,columns:r,foreignColumns:n}=this.reference(),o=r.map(m=>m.name),u=n.map(m=>m.name),l=[this.table[H.Symbol.Name],...o,n[0].table[H.Symbol.Name],...u];return e??`${l.join("_")}_fk`}}return t})();a();function dt(t,...i){return t(...i)}a();function mr(t,i){return`${t[H.Symbol.Name]}_${i.join("_")}_unique`}a();function dr(t,i,e){for(let r=i;r<t.length;r++){let n=t[r];if(n==="\\"){r++;continue}if(n==='"')return[t.slice(i,r).replace(/\\/g,""),r+1];if(!e&&(n===","||n==="}"))return[t.slice(i,r).replace(/\\/g,""),r]}return[t.slice(i).replace(/\\/g,""),t.length]}function pr(t,i=0){let e=[],r=i,n=!1;for(;r<t.length;){let o=t[r];if(o===","){(n||r===i)&&e.push(""),n=!0,r++;continue}if(n=!1,o==="\\"){r+=2;continue}if(o==='"'){let[m,S]=dr(t,r+1,!0);e.push(m),r=S;continue}if(o==="}")return[e,r+1];if(o==="{"){let[m,S]=pr(t,r+1);e.push(m),r=S;continue}let[u,l]=dr(t,r,!1);e.push(u),r=l}return[e,r]}function fr(t){let[i]=pr(t,1);return i}function Dt(t){return`{${t.map(i=>Array.isArray(i)?Dt(i):typeof i=="string"?`"${i.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`:`${i}`).join(",")}}`}var ee=(()=>{class t extends or{foreignKeyConfigs=[];static[c]="PgColumnBuilder";array(e){return new wi(this.config.name,this,e)}references(e,r={}){return this.foreignKeyConfigs.push({ref:e,actions:r}),this}unique(e,r){return this.config.isUnique=!0,this.config.uniqueName=e,this.config.uniqueType=r?.nulls,this}buildForeignKeys(e,r){return this.foreignKeyConfigs.map(({ref:n,actions:o})=>dt((u,l)=>{let m=new cr(()=>{let S=u();return{columns:[e],foreignColumns:[S]}});return l.onUpdate&&m.onUpdate(l.onUpdate),l.onDelete&&m.onDelete(l.onDelete),m.build(r)},n,o))}buildExtraConfigColumn(e){return new yi(e,this.config)}}return t})(),$=(()=>{class t extends O{constructor(e,r){r.uniqueName||(r.uniqueName=mr(e,[r.name])),super(e,r),this.table=e}static[c]="PgColumn"}return t})(),yi=(()=>{class t extends ${static[c]="ExtraConfigColumn";getSQLType(){return this.getSQLType()}indexConfig={order:this.config.order??"asc",nulls:this.config.nulls??"last",opClass:this.config.opClass};defaultConfig={order:"asc",nulls:"last",opClass:void 0};asc(){return this.indexConfig.order="asc",this}desc(){return this.indexConfig.order="desc",this}nullsFirst(){return this.indexConfig.nulls="first",this}nullsLast(){return this.indexConfig.nulls="last",this}op(e){return this.indexConfig.opClass=e,this}}return t})();var wi=(()=>{class t extends ee{static[c]="PgArrayBuilder";constructor(e,r,n){super(e,"array","PgArray"),this.config.baseBuilder=r,this.config.size=n}build(e){let r=this.config.baseBuilder.build(e);return new bi(e,this.config,r)}}return t})(),bi=(()=>{class t extends ${constructor(e,r,n,o){super(e,r),this.baseColumn=n,this.range=o,this.size=r.size}size;static[c]="PgArray";getSQLType(){return`${this.baseColumn.getSQLType()}[${typeof this.size=="number"?this.size:""}]`}mapFromDriverValue(e){return typeof e=="string"&&(e=fr(e)),e.map(r=>this.baseColumn.mapFromDriverValue(r))}mapToDriverValue(e,r=!1){let n=e.map(o=>o===null?null:d(this.baseColumn,t)?this.baseColumn.mapToDriverValue(o,!0):this.baseColumn.mapToDriverValue(o));return r?n:Dt(n)}}return t})();var Ft=Symbol.for("drizzle:isPgEnum");function hr(t){return!!t&&typeof t=="function"&&Ft in t&&t[Ft]===!0}var Si=(()=>{class t extends ee{static[c]="PgEnumColumnBuilder";constructor(e,r){super(e,"string","PgEnumColumn"),this.config.enum=r}build(e){return new xi(e,this.config)}}return t})(),xi=(()=>{class t extends ${static[c]="PgEnumColumn";enum=this.config.enum;enumValues=this.config.enum.enumValues;constructor(e,r){super(e,r),this.enum=r.enum}getSQLType(){return this.enum.enumName}}return t})();function gr(t,i,e){let r=Object.assign(n=>new Si(n,r),{enumName:t,enumValues:i,schema:e,[Ft]:!0});return r}a();var R=(()=>{class t{static[c]="Subquery";constructor(e,r,n,o=!1){this._={brand:"Subquery",sql:e,selectedFields:r,alias:n,isWith:o}}}return t})(),yr=(()=>{class t extends R{static[c]="WithSubquery"}return t})();a();a();var wr="0.31.2";var Ot,Lt,Ie={startActiveSpan(t,i){return Ot?(Lt||(Lt=Ot.trace.getTracer("drizzle-orm",wr)),dt((e,r)=>r.startActiveSpan(t,n=>{try{return i(n)}catch(o){throw n.setStatus({code:e.SpanStatusCode.ERROR,message:o instanceof Error?o.message:"Unknown error"}),o}finally{n.end()}}),Ot,Lt)):i()}};a();var B=Symbol.for("drizzle:ViewBaseConfig");function jt(t){return t!=null&&typeof t.getSQL=="function"}function vi(t){let i={sql:"",params:[]};for(let e of t)i.sql+=e.sql,i.params.push(...e.params),e.typings?.length&&(i.typings||(i.typings=[]),i.typings.push(...e.typings));return i}var I=(()=>{class t{static[c]="StringChunk";value;constructor(e){this.value=Array.isArray(e)?e:[e]}getSQL(){return new w([this])}}return t})(),w=(()=>{class t{constructor(e){this.queryChunks=e}static[c]="SQL";decoder=Sr;shouldInlineParams=!1;append(e){return this.queryChunks.push(...e.queryChunks),this}toQuery(e){return Ie.startActiveSpan("drizzle.buildSQL",r=>{let n=this.buildQueryFromSourceParams(this.queryChunks,e);return r?.setAttributes({"drizzle.query.text":n.sql,"drizzle.query.params":JSON.stringify(n.params)}),n})}buildQueryFromSourceParams(e,r){let n=Object.assign({},r,{inlineParams:r.inlineParams||this.shouldInlineParams,paramStartIndex:r.paramStartIndex||{value:0}}),{escapeName:o,escapeParam:u,prepareTyping:l,inlineParams:m,paramStartIndex:S}=n;return vi(e.map(p=>{if(d(p,I))return{sql:p.value.join(""),params:[]};if(d(p,At))return{sql:o(p.value),params:[]};if(p===void 0)return{sql:"",params:[]};if(Array.isArray(p)){let b=[new I("(")];for(let[P,q]of p.entries())b.push(q),P<p.length-1&&b.push(new I(", "));return b.push(new I(")")),this.buildQueryFromSourceParams(b,n)}if(d(p,t))return this.buildQueryFromSourceParams(p.queryChunks,ae(W({},n),{inlineParams:m||p.shouldInlineParams}));if(d(p,y)){let b=p[y.Symbol.Schema],P=p[y.Symbol.Name];return{sql:b===void 0?o(P):o(b)+"."+o(P),params:[]}}if(d(p,O))return r.invokeSource==="indexes"?{sql:o(p.name),params:[]}:{sql:o(p.table[y.Symbol.Name])+"."+o(p.name),params:[]};if(d(p,te)){let b=p[B].schema,P=p[B].name;return{sql:b===void 0?o(P):o(b)+"."+o(P),params:[]}}if(d(p,xe)){let b=p.value===null?null:p.encoder.mapToDriverValue(p.value);if(d(b,t))return this.buildQueryFromSourceParams([b],n);if(m)return{sql:this.mapInlineParam(b,n),params:[]};let P;return l!==void 0&&(P=[l(p.encoder)]),{sql:u(S.value++,b),params:[b],typings:P}}return d(p,pt)?{sql:u(S.value++,p),params:[p]}:d(p,t.Aliased)&&p.fieldAlias!==void 0?{sql:o(p.fieldAlias),params:[]}:d(p,R)?p._.isWith?{sql:o(p._.alias),params:[]}:this.buildQueryFromSourceParams([new I("("),p._.sql,new I(") "),new At(p._.alias)],n):hr(p)?p.schema?{sql:o(p.schema)+"."+o(p.enumName),params:[]}:{sql:o(p.enumName),params:[]}:jt(p)?this.buildQueryFromSourceParams([new I("("),p.getSQL(),new I(")")],n):m?{sql:this.mapInlineParam(p,n),params:[]}:{sql:u(S.value++,p),params:[p]}}))}mapInlineParam(e,{escapeString:r}){if(e===null)return"null";if(typeof e=="number"||typeof e=="boolean")return e.toString();if(typeof e=="string")return r(e);if(typeof e=="object"){let n=e.toString();return r(n==="[object Object]"?JSON.stringify(e):n)}throw new Error("Unexpected param value: "+e)}getSQL(){return this}as(e){return e===void 0?this:new t.Aliased(this,e)}mapWith(e){return this.decoder=typeof e=="function"?{mapFromDriverValue:e}:e,this}inlineParams(){return this.shouldInlineParams=!0,this}if(e){return e?this:void 0}}return t})(),At=(()=>{class t{constructor(e){this.value=e}static[c]="Name";brand;getSQL(){return new w([this])}}return t})();function br(t){return typeof t=="object"&&t!==null&&"mapToDriverValue"in t&&typeof t.mapToDriverValue=="function"}var Sr={mapFromDriverValue:t=>t},xr={mapToDriverValue:t=>t},go=W(W({},Sr),xr),xe=(()=>{class t{constructor(e,r=xr){this.value=e,this.encoder=r}static[c]="Param";brand;getSQL(){return new w([this])}}return t})();function s(t,...i){let e=[];(i.length>0||t.length>0&&t[0]!=="")&&e.push(new I(t[0]));for(let[r,n]of i.entries())e.push(n,new I(t[r+1]));return new w(e)}(t=>{function i(){return new w([])}t.empty=i;function e(m){return new w(m)}t.fromList=e;function r(m){return new w([new I(m)])}t.raw=r;function n(m,S){let p=[];for(let[b,P]of m.entries())b>0&&S!==void 0&&p.push(S),p.push(P);return new w(p)}t.join=n;function o(m){return new At(m)}t.identifier=o;function u(m){return new pt(m)}t.placeholder=u;function l(m,S){return new xe(m,S)}t.param=l})(s||(s={}));(t=>{let i=(()=>{class e{constructor(n,o){this.sql=n,this.fieldAlias=o}static[c]="SQL.Aliased";isSelectionField=!1;getSQL(){return this.sql}clone(){return new e(this.sql,this.fieldAlias)}}return e})();t.Aliased=i})(w||(w={}));var pt=(()=>{class t{constructor(e){this.name=e}static[c]="Placeholder";getSQL(){return new w([this])}}return t})();var te=(()=>{class t{static[c]="View";[B];constructor({name:e,schema:r,selectedFields:n,query:o}){this[B]={name:e,originalName:e,schema:r,selectedFields:n,query:o,isExisting:!o,isAlias:!1}}getSQL(){return new w([this])}}return t})();O.prototype.getSQL=function(){return new w([this])};y.prototype.getSQL=function(){return new w([this])};R.prototype.getSQL=function(){return new w([this])};var Me=(()=>{class t{constructor(e){this.table=e}static[c]="ColumnAliasProxyHandler";get(e,r){return r==="table"?this.table:e[r]}}return t})(),ft=(()=>{class t{constructor(e,r){this.alias=e,this.replaceOriginalName=r}static[c]="TableAliasProxyHandler";get(e,r){if(r===y.Symbol.IsAlias)return!0;if(r===y.Symbol.Name)return this.alias;if(this.replaceOriginalName&&r===y.Symbol.OriginalName)return this.alias;if(r===B)return ae(W({},e[B]),{name:this.alias,isAlias:!0});if(r===y.Symbol.Columns){let o=e[y.Symbol.Columns];if(!o)return o;let u={};return Object.keys(o).map(l=>{u[l]=new Proxy(o[l],new Me(new Proxy(e,this)))}),u}let n=e[r];return d(n,O)?new Proxy(n,new Me(new Proxy(e,this))):n}}return t})();function ht(t,i){return new Proxy(t,new ft(i,!1))}function se(t,i){return new Proxy(t,new Me(new Proxy(t.table,new ft(i,!1))))}function _t(t,i){return new w.Aliased(ke(t.sql,i),t.fieldAlias)}function ke(t,i){return s.join(t.queryChunks.map(e=>d(e,O)?se(e,i):d(e,w)?ke(e,i):d(e,w.Aliased)?_t(e,i):e))}a();a();var Vt=(()=>{class t extends ee{static[c]="PgDateColumnBaseBuilder";defaultNow(){return this.default(s`now()`)}}return t})();var vr=(()=>{class t extends ${static[c]="PgDate";getSQLType(){return"date"}mapFromDriverValue(e){return new Date(e)}mapToDriverValue(e){return e.toISOString()}}return t})();var Pr=(()=>{class t extends ${static[c]="PgDateString";getSQLType(){return"date"}}return t})();a();var Cr=(()=>{class t extends ${static[c]="PgJson";constructor(e,r){super(e,r)}getSQLType(){return"json"}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e}}return t})();a();var Tr=(()=>{class t extends ${static[c]="PgJsonb";constructor(e,r){super(e,r)}getSQLType(){return"jsonb"}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e}}return t})();a();var Pi=(()=>{class t extends ee{static[c]="PgNumericBuilder";constructor(e,r,n){super(e,"string","PgNumeric"),this.config.precision=r,this.config.scale=n}build(e){return new zt(e,this.config)}}return t})(),zt=(()=>{class t extends ${static[c]="PgNumeric";precision;scale;constructor(e,r){super(e,r),this.precision=r.precision,this.scale=r.scale}getSQLType(){return this.precision!==void 0&&this.scale!==void 0?`numeric(${this.precision}, ${this.scale})`:this.precision===void 0?"numeric":`numeric(${this.precision})`}}return t})();function gt(t,i){return new Pi(t,i?.precision,i?.scale)}a();var Ci=(()=>{class t extends ee{static[c]="PgTextBuilder";constructor(e,r){super(e,"string","PgText"),this.config.enumValues=r.enum}build(e){return new Ti(e,this.config)}}return t})(),Ti=(()=>{class t extends ${static[c]="PgText";enumValues=this.config.enumValues;getSQLType(){return"text"}}return t})();function yt(t,i={}){return new Ci(t,i)}a();var Nr=(()=>{class t extends ${static[c]="PgTime";withTimezone;precision;constructor(e,r){super(e,r),this.withTimezone=r.withTimezone,this.precision=r.precision}getSQLType(){return`time${this.precision===void 0?"":`(${this.precision})`}${this.withTimezone?" with time zone":""}`}}return t})();a();var Ni=(()=>{class t extends Vt{static[c]="PgTimestampBuilder";constructor(e,r,n){super(e,"date","PgTimestamp"),this.config.withTimezone=r,this.config.precision=n}build(e){return new It(e,this.config)}}return t})(),It=(()=>{class t extends ${static[c]="PgTimestamp";withTimezone;precision;constructor(e,r){super(e,r),this.withTimezone=r.withTimezone,this.precision=r.precision}getSQLType(){return`timestamp${this.precision===void 0?"":` (${this.precision})`}${this.withTimezone?" with time zone":""}`}mapFromDriverValue=e=>new Date(this.withTimezone?e:e+"+0000");mapToDriverValue=e=>e.toISOString()}return t})(),$i=(()=>{class t extends Vt{static[c]="PgTimestampStringBuilder";constructor(e,r,n){super(e,"string","PgTimestampString"),this.config.withTimezone=r,this.config.precision=n}build(e){return new Mt(e,this.config)}}return t})(),Mt=(()=>{class t extends ${static[c]="PgTimestampString";withTimezone;precision;constructor(e,r){super(e,r),this.withTimezone=r.withTimezone,this.precision=r.precision}getSQLType(){return`timestamp${this.precision===void 0?"":`(${this.precision})`}${this.withTimezone?" with time zone":""}`}}return t})();function Qe(t,i={}){return i.mode==="string"?new $i(t,i.withTimezone??!1,i.precision):new Ni(t,i.withTimezone??!1,i.precision)}a();var Ei=(()=>{class t extends ee{static[c]="PgUUIDBuilder";constructor(e){super(e,"string","PgUUID")}defaultRandom(){return this.default(s`gen_random_uuid()`)}build(e){return new kt(e,this.config)}}return t})(),kt=(()=>{class t extends ${static[c]="PgUUID";getSQLType(){return"uuid"}}return t})();function qe(t){return new Ei(t)}a();var $r=(()=>{class t{static[c]="QueryPromise";[Symbol.toStringTag]="QueryPromise";catch(e){return this.then(void 0,e)}finally(e){return this.then(r=>(e?.(),r),r=>{throw e?.(),r})}then(e,r){return this.execute().then(e,r)}}return t})();a();function De(t,i){return Object.entries(t).reduce((e,[r,n])=>{if(typeof r!="string")return e;let o=i?[...i,r]:[r];return d(n,O)||d(n,w)||d(n,w.Aliased)?e.push({path:o,field:n}):d(n,y)?e.push(...De(n[y.Symbol.Columns],o)):e.push(...De(n,o)),e},[])}function Qt(t,i){let e=Object.keys(t),r=Object.keys(i);if(e.length!==r.length)return!1;for(let[n,o]of e.entries())if(o!==r[n])return!1;return!0}function Er(t,i){for(let e of i)for(let r of Object.getOwnPropertyNames(e.prototype))r!=="constructor"&&Object.defineProperty(t.prototype,r,Object.getOwnPropertyDescriptor(e.prototype,r)||Object.create(null))}function Ke(t){return t[y.Symbol.Columns]}function Kt(t){return d(t,R)?t._.alias:d(t,te)?t[B].name:d(t,w)?void 0:t[y.Symbol.IsAlias]?t[y.Symbol.Name]:t[y.Symbol.BaseName]}a();a();a();var Br=(()=>{class t extends Error{static[c]="DrizzleError";constructor({message:e,cause:r}){super(e),this.name="DrizzleError",this.cause=r}}return t})();a();a();function Z(t,i){return br(i)&&!jt(t)&&!d(t,xe)&&!d(t,pt)&&!d(t,O)&&!d(t,y)&&!d(t,te)?new xe(t,i):t}var wt=(t,i)=>s`${t} = ${Z(i,t)}`,qr=(t,i)=>s`${t} <> ${Z(i,t)}`;function Re(...t){let i=t.filter(e=>e!==void 0);if(i.length!==0)return i.length===1?new w(i):new w([new I("("),s.join(i,new I(" and ")),new I(")")])}function Dr(...t){let i=t.filter(e=>e!==void 0);if(i.length!==0)return i.length===1?new w(i):new w([new I("("),s.join(i,new I(" or ")),new I(")")])}function Fr(t){return s`not ${t}`}var Or=(t,i)=>s`${t} > ${Z(i,t)}`,Lr=(t,i)=>s`${t} >= ${Z(i,t)}`,Ar=(t,i)=>s`${t} < ${Z(i,t)}`,jr=(t,i)=>s`${t} <= ${Z(i,t)}`;function _r(t,i){if(Array.isArray(i)){if(i.length===0)throw new Error("inArray requires at least one value");return s`${t} in ${i.map(e=>Z(e,t))}`}return s`${t} in ${Z(i,t)}`}function Vr(t,i){if(Array.isArray(i)){if(i.length===0)throw new Error("notInArray requires at least one value");return s`${t} not in ${i.map(e=>Z(e,t))}`}return s`${t} not in ${Z(i,t)}`}function zr(t){return s`${t} is null`}function Ir(t){return s`${t} is not null`}function Mr(t){return s`exists ${t}`}function kr(t){return s`not exists ${t}`}function Qr(t,i,e){return s`${t} between ${Z(i,t)} and ${Z(e,t)}`}function Kr(t,i,e){return s`${t} not between ${Z(i,t)} and ${Z(e,t)}`}function Rr(t,i){return s`${t} like ${i}`}function Ur(t,i){return s`${t} not like ${i}`}function Jr(t,i){return s`${t} ilike ${i}`}function Hr(t,i){return s`${t} not ilike ${i}`}a();function Wr(t){return s`${t} asc`}function Gr(t){return s`${t} desc`}var Zr=(()=>{class t{constructor(e,r,n){this.sourceTable=e,this.referencedTable=r,this.relationName=n,this.referencedTableName=r[y.Symbol.Name]}static[c]="Relation";referencedTableName;fieldName}return t})();var bt=(()=>{class t extends Zr{constructor(e,r,n,o){super(e,r,n?.relationName),this.config=n,this.isNullable=o}static[c]="One";withFieldName(e){let r=new t(this.sourceTable,this.referencedTable,this.config,this.isNullable);return r.fieldName=e,r}}return t})(),Yr=(()=>{class t extends Zr{constructor(e,r,n){super(e,r,n?.relationName),this.config=n}static[c]="Many";withFieldName(e){let r=new t(this.sourceTable,this.referencedTable,this.config);return r.fieldName=e,r}}return t})();function Xr(){return{and:Re,between:Qr,eq:wt,exists:Mr,gt:Or,gte:Lr,ilike:Jr,inArray:_r,isNull:zr,isNotNull:Ir,like:Rr,lt:Ar,lte:jr,ne:qr,not:Fr,notBetween:Kr,notExists:kr,notLike:Ur,notIlike:Hr,notInArray:Vr,or:Dr,sql:s}}function ei(){return{sql:s,asc:Wr,desc:Gr}}function ti(t,i,e){if(d(e,bt)&&e.config)return{fields:e.config.fields,references:e.config.references};let r=i[e.referencedTable[y.Symbol.Name]];if(!r)throw new Error(`Table "${e.referencedTable[y.Symbol.Name]}" not found in schema`);let n=t[r];if(!n)throw new Error(`Table "${r}" not found in schema`);let o=e.sourceTable,u=i[o[y.Symbol.Name]];if(!u)throw new Error(`Table "${o[y.Symbol.Name]}" not found in schema`);let l=[];for(let m of Object.values(n.relations))(e.relationName&&e!==m&&m.relationName===e.relationName||!e.relationName&&m.referencedTable===e.sourceTable)&&l.push(m);if(l.length>1)throw e.relationName?new Error(`There are multiple relations with name "${e.relationName}" in table "${r}"`):new Error(`There are multiple relations between "${r}" and "${e.sourceTable[y.Symbol.Name]}". Please specify relation name`);if(l[0]&&d(l[0],bt)&&l[0].config)return{fields:l[0].config.references,references:l[0].config.fields};throw new Error(`There is not enough information to infer relation "${u}.${e.fieldName}"`)}a();var ve=(()=>{class t extends te{static[c]="PgViewBase"}return t})();var ri=(()=>{class t{static[c]="PgDialect";async migrate(e,r,n){let o=typeof n=="string"?"__drizzle_migrations":n.migrationsTable??"__drizzle_migrations",u=typeof n=="string"?"drizzle":n.migrationsSchema??"drizzle",l=s`
			CREATE TABLE IF NOT EXISTS ${s.identifier(u)}.${s.identifier(o)} (
				id SERIAL PRIMARY KEY,
				hash text NOT NULL,
				created_at bigint
			)
		`;await r.execute(s`CREATE SCHEMA IF NOT EXISTS ${s.identifier(u)}`),await r.execute(l);let S=(await r.all(s`select id, hash, created_at from ${s.identifier(u)}.${s.identifier(o)} order by created_at desc limit 1`))[0];await r.transaction(async p=>{for await(let b of e)if(!S||Number(S.created_at)<b.folderMillis){for(let P of b.sql)await p.execute(s.raw(P));await p.execute(s`insert into ${s.identifier(u)}.${s.identifier(o)} ("hash", "created_at") values(${b.hash}, ${b.folderMillis})`)}})}escapeName(e){return`"${e}"`}escapeParam(e){return`$${e+1}`}escapeString(e){return`'${e.replace(/'/g,"''")}'`}buildWithCTE(e){if(!e?.length)return;let r=[s`with `];for(let[n,o]of e.entries())r.push(s`${s.identifier(o._.alias)} as (${o._.sql})`),n<e.length-1&&r.push(s`, `);return r.push(s` `),s.join(r)}buildDeleteQuery({table:e,where:r,returning:n,withList:o}){let u=this.buildWithCTE(o),l=n?s` returning ${this.buildSelection(n,{isSingleTable:!0})}`:void 0,m=r?s` where ${r}`:void 0;return s`${u}delete from ${e}${m}${l}`}buildUpdateSet(e,r){let n=e[y.Symbol.Columns],o=Object.keys(n).filter(l=>r[l]!==void 0||n[l]?.onUpdateFn!==void 0),u=o.length;return s.join(o.flatMap((l,m)=>{let S=n[l],p=r[l]??s.param(S.onUpdateFn(),S),b=s`${s.identifier(S.name)} = ${p}`;return m<u-1?[b,s.raw(", ")]:[b]}))}buildUpdateQuery({table:e,set:r,where:n,returning:o,withList:u}){let l=this.buildWithCTE(u),m=this.buildUpdateSet(e,r),S=o?s` returning ${this.buildSelection(o,{isSingleTable:!0})}`:void 0,p=n?s` where ${n}`:void 0;return s`${l}update ${e} set ${m}${p}${S}`}buildSelection(e,{isSingleTable:r=!1}={}){let n=e.length,o=e.flatMap(({field:u},l)=>{let m=[];if(d(u,w.Aliased)&&u.isSelectionField)m.push(s.identifier(u.fieldAlias));else if(d(u,w.Aliased)||d(u,w)){let S=d(u,w.Aliased)?u.sql:u;r?m.push(new w(S.queryChunks.map(p=>d(p,$)?s.identifier(p.name):p))):m.push(S),d(u,w.Aliased)&&m.push(s` as ${s.identifier(u.fieldAlias)}`)}else d(u,O)&&(r?m.push(s.identifier(u.name)):m.push(u));return l<n-1&&m.push(s`, `),m});return s.join(o)}buildSelectQuery({withList:e,fields:r,fieldsFlat:n,where:o,having:u,table:l,joins:m,orderBy:S,groupBy:p,limit:b,offset:P,lockingClause:q,distinct:Q,setOperators:A}){let M=n??De(r);for(let F of M)if(d(F.field,O)&&Ee(F.field.table)!==(d(l,R)?l._.alias:d(l,ve)?l[B].name:d(l,w)?void 0:Ee(l))&&!(_=>m?.some(({alias:Y})=>Y===(_[y.Symbol.IsAlias]?Ee(_):_[y.Symbol.BaseName])))(F.field.table)){let _=Ee(F.field.table);throw new Error(`Your "${F.path.join("->")}" field references a column "${_}"."${F.field.name}", but the table "${_}" is not part of the query! Did you forget to join it?`)}let D=!m||m.length===0,j=this.buildWithCTE(e),V;Q&&(V=Q===!0?s` distinct`:s` distinct on (${s.join(Q.on,s`, `)})`);let z=this.buildSelection(M,{isSingleTable:D}),L=(()=>{if(d(l,y)&&l[y.Symbol.OriginalName]!==l[y.Symbol.Name]){let F=s`${s.identifier(l[y.Symbol.OriginalName])}`;return l[y.Symbol.Schema]&&(F=s`${s.identifier(l[y.Symbol.Schema])}.${F}`),s`${F} ${s.identifier(l[y.Symbol.Name])}`}return l})(),U=[];if(m)for(let[F,_]of m.entries()){F===0&&U.push(s` `);let Y=_.table,je=_.lateral?s` lateral`:void 0;if(d(Y,H)){let vt=Y[H.Symbol.Name],_e=Y[H.Symbol.Schema],Ve=Y[H.Symbol.OriginalName],ze=vt===Ve?void 0:_.alias;U.push(s`${s.raw(_.joinType)} join${je} ${_e?s`${s.identifier(_e)}.`:void 0}${s.identifier(Ve)}${ze&&s` ${s.identifier(ze)}`} on ${_.on}`)}else if(d(Y,te)){let vt=Y[B].name,_e=Y[B].schema,Ve=Y[B].originalName,ze=vt===Ve?void 0:_.alias;U.push(s`${s.raw(_.joinType)} join${je} ${_e?s`${s.identifier(_e)}.`:void 0}${s.identifier(Ve)}${ze&&s` ${s.identifier(ze)}`} on ${_.on}`)}else U.push(s`${s.raw(_.joinType)} join${je} ${Y} on ${_.on}`);F<m.length-1&&U.push(s` `)}let de=s.join(U),C=o?s` where ${o}`:void 0,N=u?s` having ${u}`:void 0,ie;S&&S.length>0&&(ie=s` order by ${s.join(S,s`, `)}`);let Le;p&&p.length>0&&(Le=s` group by ${s.join(p,s`, `)}`);let xt=b?s` limit ${b}`:void 0,Ae=P?s` offset ${P}`:void 0,pe=s.empty();if(q){let F=s` for ${s.raw(q.strength)}`;q.config.of&&F.append(s` of ${s.join(Array.isArray(q.config.of)?q.config.of:[q.config.of],s`, `)}`),q.config.noWait?F.append(s` no wait`):q.config.skipLocked&&F.append(s` skip locked`),pe.append(F)}let He=s`${j}select${V} ${z} from ${L}${de}${C}${Le}${N}${ie}${xt}${Ae}${pe}`;return A.length>0?this.buildSetOperations(He,A):He}buildSetOperations(e,r){let[n,...o]=r;if(!n)throw new Error("Cannot pass undefined values to any set operator");return o.length===0?this.buildSetOperationQuery({leftSelect:e,setOperator:n}):this.buildSetOperations(this.buildSetOperationQuery({leftSelect:e,setOperator:n}),o)}buildSetOperationQuery({leftSelect:e,setOperator:{type:r,isAll:n,rightSelect:o,limit:u,orderBy:l,offset:m}}){let S=s`(${e.getSQL()}) `,p=s`(${o.getSQL()})`,b;if(l&&l.length>0){let A=[];for(let M of l)if(d(M,$))A.push(s.identifier(M.name));else if(d(M,w)){for(let D=0;D<M.queryChunks.length;D++){let j=M.queryChunks[D];d(j,$)&&(M.queryChunks[D]=s.identifier(j.name))}A.push(s`${M}`)}else A.push(s`${M}`);b=s` order by ${s.join(A,s`, `)} `}let P=u?s` limit ${u}`:void 0,q=s.raw(`${r} ${n?"all ":""}`),Q=m?s` offset ${m}`:void 0;return s`${S}${q}${p}${b}${P}${Q}`}buildInsertQuery({table:e,values:r,onConflict:n,returning:o,withList:u}){let l=[],m=e[y.Symbol.Columns],S=Object.entries(m),p=S.map(([,A])=>s.identifier(A.name));for(let[A,M]of r.entries()){let D=[];for(let[j,V]of S){let z=M[j];if(z===void 0||d(z,xe)&&z.value===void 0)if(V.defaultFn!==void 0){let L=V.defaultFn(),U=d(L,w)?L:s.param(L,V);D.push(U)}else if(!V.default&&V.onUpdateFn!==void 0){let L=V.onUpdateFn(),U=d(L,w)?L:s.param(L,V);D.push(U)}else D.push(s`default`);else D.push(z)}l.push(D),A<r.length-1&&l.push(s`, `)}let b=this.buildWithCTE(u),P=s.join(l),q=o?s` returning ${this.buildSelection(o,{isSingleTable:!0})}`:void 0,Q=n?s` on conflict ${n}`:void 0;return s`${b}insert into ${e} ${p} values ${P}${Q}${q}`}buildRefreshMaterializedViewQuery({view:e,concurrently:r,withNoData:n}){let o=r?s` concurrently`:void 0,u=n?s` with no data`:void 0;return s`refresh materialized view${o} ${e}${u}`}prepareTyping(e){return d(e,Tr)||d(e,Cr)?"json":d(e,zt)?"decimal":d(e,Nr)?"time":d(e,It)||d(e,Mt)?"timestamp":d(e,vr)||d(e,Pr)?"date":d(e,kt)?"uuid":"none"}sqlToQuery(e,r){return e.toQuery({escapeName:this.escapeName,escapeParam:this.escapeParam,escapeString:this.escapeString,prepareTyping:this.prepareTyping,invokeSource:r})}buildRelationalQueryWithoutPK({fullSchema:e,schema:r,tableNamesMap:n,table:o,tableConfig:u,queryConfig:l,tableAlias:m,nestedQueryRelation:S,joinOn:p}){let b=[],P,q,Q=[],A,M=[];if(l===!0)b=Object.entries(u.columns).map(([V,z])=>({dbKey:z.name,tsKey:V,field:se(z,m),relationTableTsKey:void 0,isJson:!1,selection:[]}));else{let j=Object.fromEntries(Object.entries(u.columns).map(([C,N])=>[C,se(N,m)]));if(l.where){let C=typeof l.where=="function"?l.where(j,Xr()):l.where;A=C&&ke(C,m)}let V=[],z=[];if(l.columns){let C=!1;for(let[N,ie]of Object.entries(l.columns))ie!==void 0&&N in u.columns&&(!C&&ie===!0&&(C=!0),z.push(N));z.length>0&&(z=C?z.filter(N=>l.columns?.[N]===!0):Object.keys(u.columns).filter(N=>!z.includes(N)))}else z=Object.keys(u.columns);for(let C of z){let N=u.columns[C];V.push({tsKey:C,value:N})}let L=[];l.with&&(L=Object.entries(l.with).filter(C=>!!C[1]).map(([C,N])=>({tsKey:C,queryConfig:N,relation:u.relations[C]})));let U;if(l.extras){U=typeof l.extras=="function"?l.extras(j,{sql:s}):l.extras;for(let[C,N]of Object.entries(U))V.push({tsKey:C,value:_t(N,m)})}for(let{tsKey:C,value:N}of V)b.push({dbKey:d(N,w.Aliased)?N.fieldAlias:u.columns[C].name,tsKey:C,field:d(N,O)?se(N,m):N,relationTableTsKey:void 0,isJson:!1,selection:[]});let de=typeof l.orderBy=="function"?l.orderBy(j,ei()):l.orderBy??[];Array.isArray(de)||(de=[de]),Q=de.map(C=>d(C,O)?se(C,m):ke(C,m)),P=l.limit,q=l.offset;for(let{tsKey:C,queryConfig:N,relation:ie}of L){let Le=ti(r,n,ie),xt=ie.referencedTable[y.Symbol.Name],Ae=n[xt],pe=`${m}_${C}`,He=Re(...Le.fields.map((Y,je)=>wt(se(Le.references[je],pe),se(Y,m)))),F=this.buildRelationalQueryWithoutPK({fullSchema:e,schema:r,tableNamesMap:n,table:e[Ae],tableConfig:r[Ae],queryConfig:d(ie,bt)?N===!0?{limit:1}:ae(W({},N),{limit:1}):N,tableAlias:pe,joinOn:He,nestedQueryRelation:ie}),_=s`${s.identifier(pe)}.${s.identifier("data")}`.as(C);M.push({on:s`true`,table:new R(F.sql,{},pe),alias:pe,joinType:"left",lateral:!0}),b.push({dbKey:C,tsKey:C,field:_,relationTableTsKey:Ae,isJson:!0,selection:F.selection})}}if(b.length===0)throw new Br({message:`No fields selected for table "${u.tsName}" ("${m}")`});let D;if(A=Re(p,A),S){let j=s`json_build_array(${s.join(b.map(({field:L,tsKey:U,isJson:de})=>de?s`${s.identifier(`${m}_${U}`)}.${s.identifier("data")}`:d(L,w.Aliased)?L.sql:L),s`, `)})`;d(S,Yr)&&(j=s`coalesce(json_agg(${j}${Q.length>0?s` order by ${s.join(Q,s`, `)}`:void 0}), '[]'::json)`);let V=[{dbKey:"data",tsKey:"data",field:j.as("data"),isJson:!0,relationTableTsKey:u.tsName,selection:b}];P!==void 0||q!==void 0||Q.length>0?(D=this.buildSelectQuery({table:ht(o,m),fields:{},fieldsFlat:[{path:[],field:s.raw("*")}],where:A,limit:P,offset:q,orderBy:Q,setOperators:[]}),A=void 0,P=void 0,q=void 0,Q=[]):D=ht(o,m),D=this.buildSelectQuery({table:d(D,H)?D:new R(D,{},m),fields:{},fieldsFlat:V.map(({field:L})=>({path:[],field:d(L,O)?se(L,m):L})),joins:M,where:A,limit:P,offset:q,orderBy:Q,setOperators:[]})}else D=this.buildSelectQuery({table:ht(o,m),fields:{},fieldsFlat:b.map(({field:j})=>({path:[],field:d(j,O)?se(j,m):j})),joins:M,where:A,limit:P,offset:q,orderBy:Q,setOperators:[]});return{tableTsKey:u.tsName,sql:D,selection:b}}}return t})();a();var k=(()=>{class t{static[c]="SelectionProxyHandler";config;constructor(e){this.config=W({},e)}get(e,r){if(r==="_")return ae(W({},e._),{selectedFields:new Proxy(e._.selectedFields,this)});if(r===B)return ae(W({},e[B]),{selectedFields:new Proxy(e[B].selectedFields,this)});if(typeof r=="symbol")return e[r];let o=(d(e,R)?e._.selectedFields:d(e,te)?e[B].selectedFields:e)[r];if(d(o,w.Aliased)){if(this.config.sqlAliasedBehavior==="sql"&&!o.isSelectionField)return o.sql;let u=o.clone();return u.isSelectionField=!0,u}if(d(o,w)){if(this.config.sqlBehavior==="sql")return o;throw new Error(`You tried to reference "${r}" field from a subquery, which is a raw SQL field, but it doesn't have an alias declared. Please add an alias to the field using ".as('alias')" method.`)}return d(o,O)?this.config.alias?new Proxy(o,new Me(new Proxy(o.table,new ft(this.config.alias,this.config.replaceOriginalName??!1)))):o:typeof o!="object"||o===null?o:new Proxy(o,new t(this.config))}}return t})();a();a();var ii=(()=>{class t{static[c]="TypedQueryBuilder";getSelectedFields(){return this._.selectedFields}}return t})();var Pe=(()=>{class t{static[c]="PgSelectBuilder";fields;session;dialect;withList=[];distinct;constructor(e){this.fields=e.fields,this.session=e.session,this.dialect=e.dialect,e.withList&&(this.withList=e.withList),this.distinct=e.distinct}from(e){let r=!!this.fields,n;return this.fields?n=this.fields:d(e,R)?n=Object.fromEntries(Object.keys(e._.selectedFields).map(o=>[o,e[o]])):d(e,ve)?n=e[B].selectedFields:d(e,w)?n={}:n=Ke(e),new ni({table:e,fields:n,isPartialSelect:r,session:this.session,dialect:this.dialect,withList:this.withList,distinct:this.distinct})}}return t})(),Bi=(()=>{class t extends ii{static[c]="PgSelectQueryBuilder";_;config;joinsNotNullableMap;tableName;isPartialSelect;session;dialect;constructor({table:e,fields:r,isPartialSelect:n,session:o,dialect:u,withList:l,distinct:m}){super(),this.config={withList:l,table:e,fields:W({},r),distinct:m,setOperators:[]},this.isPartialSelect=n,this.session=o,this.dialect=u,this._={selectedFields:r},this.tableName=Kt(e),this.joinsNotNullableMap=typeof this.tableName=="string"?{[this.tableName]:!0}:{}}createJoin(e){return(r,n)=>{let o=this.tableName,u=Kt(r);if(typeof u=="string"&&this.config.joins?.some(l=>l.alias===u))throw new Error(`Alias "${u}" is already used in this query`);if(!this.isPartialSelect&&(Object.keys(this.joinsNotNullableMap).length===1&&typeof o=="string"&&(this.config.fields={[o]:this.config.fields}),typeof u=="string"&&!d(r,w))){let l=d(r,R)?r._.selectedFields:d(r,te)?r[B].selectedFields:r[y.Symbol.Columns];this.config.fields[u]=l}if(typeof n=="function"&&(n=n(new Proxy(this.config.fields,new k({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.joins||(this.config.joins=[]),this.config.joins.push({on:n,table:r,joinType:e,alias:u}),typeof u=="string")switch(e){case"left":{this.joinsNotNullableMap[u]=!1;break}case"right":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([l])=>[l,!1])),this.joinsNotNullableMap[u]=!0;break}case"inner":{this.joinsNotNullableMap[u]=!0;break}case"full":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([l])=>[l,!1])),this.joinsNotNullableMap[u]=!1;break}}return this}}leftJoin=this.createJoin("left");rightJoin=this.createJoin("right");innerJoin=this.createJoin("inner");fullJoin=this.createJoin("full");createSetOperator(e,r){return n=>{let o=typeof n=="function"?n(qi()):n;if(!Qt(this.getSelectedFields(),o.getSelectedFields()))throw new Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return this.config.setOperators.push({type:e,isAll:r,rightSelect:o}),this}}union=this.createSetOperator("union",!1);unionAll=this.createSetOperator("union",!0);intersect=this.createSetOperator("intersect",!1);intersectAll=this.createSetOperator("intersect",!0);except=this.createSetOperator("except",!1);exceptAll=this.createSetOperator("except",!0);addSetOperators(e){return this.config.setOperators.push(...e),this}where(e){return typeof e=="function"&&(e=e(new Proxy(this.config.fields,new k({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.where=e,this}having(e){return typeof e=="function"&&(e=e(new Proxy(this.config.fields,new k({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.having=e,this}groupBy(...e){if(typeof e[0]=="function"){let r=e[0](new Proxy(this.config.fields,new k({sqlAliasedBehavior:"alias",sqlBehavior:"sql"})));this.config.groupBy=Array.isArray(r)?r:[r]}else this.config.groupBy=e;return this}orderBy(...e){if(typeof e[0]=="function"){let r=e[0](new Proxy(this.config.fields,new k({sqlAliasedBehavior:"alias",sqlBehavior:"sql"}))),n=Array.isArray(r)?r:[r];this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=n:this.config.orderBy=n}else{let r=e;this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=r:this.config.orderBy=r}return this}limit(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).limit=e:this.config.limit=e,this}offset(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).offset=e:this.config.offset=e,this}for(e,r={}){return this.config.lockingClause={strength:e,config:r},this}getSQL(){return this.dialect.buildSelectQuery(this.config)}toSQL(){let n=this.dialect.sqlToQuery(this.getSQL()),{typings:e}=n;return er(n,["typings"])}as(e){return new Proxy(new R(this.getSQL(),this.config.fields,e),new k({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}getSelectedFields(){return new Proxy(this.config.fields,new k({alias:this.tableName,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}$dynamic(){return this}}return t})(),ni=(()=>{class t extends Bi{static[c]="PgSelect";_prepare(e){let{session:r,config:n,dialect:o,joinsNotNullableMap:u}=this;if(!r)throw new Error("Cannot execute a query on a query builder. Please use a database instance instead.");return Ie.startActiveSpan("drizzle.prepareQuery",()=>{let l=De(n.fields),m=r.prepareQuery(o.sqlToQuery(this.getSQL()),l,e,!0);return m.joinsNotNullableMap=u,m})}prepare(e){return this._prepare(e)}execute=e=>Ie.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e))}return t})();Er(ni,[$r]);function Fe(t,i){return(e,r,...n)=>{let o=[r,...n].map(u=>({type:t,isAll:i,rightSelect:u}));for(let u of o)if(!Qt(e.getSelectedFields(),u.rightSelect.getSelectedFields()))throw new Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return e.addSetOperators(o)}}var qi=()=>({union:Di,unionAll:Fi,intersect:Oi,intersectAll:Li,except:Ai,exceptAll:ji}),Di=Fe("union",!1),Fi=Fe("union",!0),Oi=Fe("intersect",!1),Li=Fe("intersect",!0),Ai=Fe("except",!1),ji=Fe("except",!0);var Rt=(()=>{class t{static[c]="PgQueryBuilder";dialect;$with(e){let r=this;return{as(n){return typeof n=="function"&&(n=n(r)),new Proxy(new yr(n.getSQL(),n.getSelectedFields(),e,!0),new k({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}}}with(...e){let r=this;function n(l){return new Pe({fields:l??void 0,session:void 0,dialect:r.getDialect(),withList:e})}function o(l){return new Pe({fields:l??void 0,session:void 0,dialect:r.getDialect(),distinct:!0})}function u(l,m){return new Pe({fields:m??void 0,session:void 0,dialect:r.getDialect(),distinct:{on:l}})}return{select:n,selectDistinct:o,selectDistinctOn:u}}select(e){return new Pe({fields:e??void 0,session:void 0,dialect:this.getDialect()})}selectDistinct(e){return new Pe({fields:e??void 0,session:void 0,dialect:this.getDialect(),distinct:!0})}selectDistinctOn(e,r){return new Pe({fields:r??void 0,session:void 0,dialect:this.getDialect(),distinct:{on:e}})}getDialect(){return this.dialect||(this.dialect=new ri),this.dialect}}return t})();a();a();a();var Ut=Symbol.for("drizzle:PgViewConfig");var si=(()=>{class t{constructor(e,r){this.name=e,this.schema=r}static[c]="PgDefaultViewBuilderCore";config={};with(e){return this.config.with=e,this}}return t})(),_i=(()=>{class t extends si{static[c]="PgViewBuilder";as(e){typeof e=="function"&&(e=e(new Rt));let r=new k({alias:this.name,sqlBehavior:"error",sqlAliasedBehavior:"alias",replaceOriginalName:!0}),n=new Proxy(e.getSelectedFields(),r);return new Proxy(new Jt({pgConfig:this.config,config:{name:this.name,schema:this.schema,selectedFields:n,query:e.getSQL().inlineParams()}}),r)}}return t})(),Vi=(()=>{class t extends si{static[c]="PgManualViewBuilder";columns;constructor(e,r,n){super(e,n),this.columns=Ke(Be(e,r))}existing(){return new Proxy(new Jt({pgConfig:void 0,config:{name:this.name,schema:this.schema,selectedFields:this.columns,query:void 0}}),new k({alias:this.name,sqlBehavior:"error",sqlAliasedBehavior:"alias",replaceOriginalName:!0}))}as(e){return new Proxy(new Jt({pgConfig:this.config,config:{name:this.name,schema:this.schema,selectedFields:this.columns,query:e.inlineParams()}}),new k({alias:this.name,sqlBehavior:"error",sqlAliasedBehavior:"alias",replaceOriginalName:!0}))}}return t})(),ai=(()=>{class t{constructor(e,r){this.name=e,this.schema=r}static[c]="PgMaterializedViewBuilderCore";config={};using(e){return this.config.using=e,this}with(e){return this.config.with=e,this}tablespace(e){return this.config.tablespace=e,this}withNoData(){return this.config.withNoData=!0,this}}return t})(),zi=(()=>{class t extends ai{static[c]="PgMaterializedViewBuilder";as(e){typeof e=="function"&&(e=e(new Rt));let r=new k({alias:this.name,sqlBehavior:"error",sqlAliasedBehavior:"alias",replaceOriginalName:!0}),n=new Proxy(e.getSelectedFields(),r);return new Proxy(new Ht({pgConfig:{with:this.config.with,using:this.config.using,tablespace:this.config.tablespace,withNoData:this.config.withNoData},config:{name:this.name,schema:this.schema,selectedFields:n,query:e.getSQL().inlineParams()}}),r)}}return t})(),Ii=(()=>{class t extends ai{static[c]="PgManualMaterializedViewBuilder";columns;constructor(e,r,n){super(e,n),this.columns=Ke(Be(e,r))}existing(){return new Proxy(new Ht({pgConfig:void 0,config:{name:this.name,schema:this.schema,selectedFields:this.columns,query:void 0}}),new k({alias:this.name,sqlBehavior:"error",sqlAliasedBehavior:"alias",replaceOriginalName:!0}))}as(e){return new Proxy(new Ht({pgConfig:void 0,config:{name:this.name,schema:this.schema,selectedFields:this.columns,query:e.inlineParams()}}),new k({alias:this.name,sqlBehavior:"error",sqlAliasedBehavior:"alias",replaceOriginalName:!0}))}}return t})(),Jt=(()=>{class t extends ve{static[c]="PgView";[Ut];constructor({pgConfig:e,config:r}){super(r),e&&(this[Ut]={with:e.with})}}return t})(),oi=Symbol.for("drizzle:PgMaterializedViewConfig"),Ht=(()=>{class t extends ve{static[c]="PgMaterializedView";[oi];constructor({pgConfig:e,config:r}){super(r),this[oi]={with:e?.with,using:e?.using,tablespace:e?.tablespace,withNoData:e?.withNoData}}}return t})();function li(t,i,e){return i?new Vi(t,i,e):new _i(t,e)}function ui(t,i,e){return i?new Ii(t,i,e):new zi(t,e)}var Mi=(()=>{class t{constructor(e){this.schemaName=e}static[c]="PgSchema";table=(e,r,n)=>qt(e,r,n,this.schemaName);view=(e,r)=>li(e,r,this.schemaName);materializedView=(e,r)=>ui(e,r,this.schemaName);enum=(e,r)=>gr(e,r,this.schemaName)}return t})();function ci(t){if(t==="public")throw new Error("You can't specify 'public' as schema name. Postgres is using public schema by default. If you want to use 'public' schema, just use pgTable() instead of creating a schema");return new Mi(t)}var ki=ci("auth"),Qi=ki.table("users",{id:qe("id").primaryKey()}),Ce="property",Ki=Be(Ce,{id:qe("id").primaryKey().defaultRandom(),name:yt("name").notNull(),address:yt("address").notNull(),rent:gt("rent",{precision:9,scale:2}).notNull(),mortgage:gt("mortgage",{precision:9,scale:2}).notNull(),userId:qe("user_id").notNull().references(()=>Qi.id,{onDelete:"cascade"}),createdAt:Qe("created_at").notNull().defaultNow(),updatedAt:Qe("updated_at").notNull().defaultNow()}),Ue="expense",ll=Be(Ue,{id:qe("id").primaryKey().defaultRandom(),name:yt("name").notNull(),amount:gt("amount",{precision:7,scale:2}).notNull(),propertyId:qe("property_id").notNull().references(()=>Ki.id,{onDelete:"cascade"}),createdAt:Qe("created_at").notNull().defaultNow(),updatedAt:Qe("updated_at").notNull().defaultNow()});var St=(()=>{let i=class i{constructor(){this.supabaseClient=E(tt)}async createExpense(r,n,o){return this.supabaseClient.from(Ue).insert({name:r,amount:n,property_id:o}).select().single()}async readExpenses(r){return this.supabaseClient.from(Ue).select().eq("property_id",r)}async deleteExpense(r){return this.supabaseClient.from(Ue).delete().eq("id",r)}};i.\u0275fac=function(n){return new(n||i)},i.\u0275prov=fe({token:i,factory:i.\u0275fac,providedIn:"root"});let t=i;return t})();a();var Wt=(()=>{let i=class i{createForm(){return new ot({name:new Se("",{validators:[be.required],nonNullable:!0}),amount:new Se(0,{validators:[be.required],nonNullable:!0})})}};i.\u0275fac=function(n){return new(n||i)},i.\u0275prov=fe({token:i,factory:i.\u0275fac});let t=i;return t})();var Ui=t=>["/properties","detail",t];function Ji(t,i){t&1&&T(0,"span",14)}var mi=(()=>{let i=class i{constructor(){this.createExpenseForm=E(Wt).createForm(),this.expensesDataService=E(St),this.router=E($e),this.activatedRoute=E(Ne),this.isLoading=X(!1),this.propertyId=X(""),this.propertyId.set(this.activatedRoute.snapshot.params.propertyId)}async createExpense(){if(this.createExpenseForm.valid)try{this.isLoading.set(!0);let{data:r,error:n}=await this.expensesDataService.createExpense(this.createExpenseForm.controls.name.value,this.createExpenseForm.controls.amount.value,this.propertyId());n&&console.error(n),r&&this.router.navigate(["properties","detail",this.propertyId()],{fragment:"expenses"})}catch(r){r instanceof Error&&console.error(r),this.isLoading.set(!1)}finally{this.isLoading.set(!1)}}};i.\u0275fac=function(n){return new(n||i)},i.\u0275cmp=he({type:i,selectors:[["propertea-expense-create"]],standalone:!0,features:[et([Wt]),ye],decls:22,vars:5,consts:[[1,"text-5xl","font-bold"],[1,"flex","flex-col","items-center",3,"submit","formGroup"],["for","name",1,"form-control","w-full","max-w-xs"],[1,"label"],[1,"label-text"],["formControlName","name","id","name","type","text","required","required",1,"input","input-bordered","w-full","max-w-xs"],["for","amount",1,"form-control","w-full","max-w-xl","mt-4"],[1,"input","input-bordered","flex","items-center","gap-2","w-full","max-w-xl"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke-width","1.5","stroke","currentColor",1,"h-5","w-5","opacity-70"],["stroke-linecap","round","stroke-linejoin","round","d","M12 6v12m-3-2.818.879.659c1.171.879 3.07.879 4.242 0 1.172-.879 1.172-2.303 0-3.182C13.536 12.219 12.768 12 12 12c-.725 0-1.45-.22-2.003-.659-1.106-.879-1.106-2.303 0-3.182s2.9-.879 4.006 0l.415.33M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"],["formControlName","amount","id","amount","type","text","required","required",1,"grow"],[1,"flex","gap-4","mt-4"],["fragment","expenses",1,"btn","btn-error",3,"routerLink"],["type","submit",1,"btn","btn-success"],[1,"loading","loading-spinner"]],template:function(n,o){n&1&&(f(0,"h1",0),v(1,"Expense Creation"),h(),f(2,"form",1),oe("submit",function(){return o.createExpense()}),f(3,"label",2)(4,"div",3)(5,"span",4),v(6,"Name"),h()(),T(7,"input",5),h(),f(8,"label",6)(9,"div",3)(10,"span",4),v(11,"Amount"),h()(),f(12,"div",7),K(),f(13,"svg",8),T(14,"path",9),h(),G(),T(15,"input",10),h()(),f(16,"div",11)(17,"a",12),v(18,"Cancel"),h(),f(19,"button",13),le(20,Ji,1,0,"span",14),v(21," Create "),h()()()),n&2&&(x(2),J("formGroup",o.createExpenseForm),x(15),J("routerLink",me(3,Ui,o.propertyId())),x(3),ne(o.isLoading()?20:-1))},dependencies:[we,ct,st,rt,it,nt,ut,at,lt],styles:[".property-image[_ngcontent-%COMP%]{height:150px;width:300px}"],changeDetection:0});let t=i;return t})();a();a();var Oe=(()=>{let i=class i{constructor(){this.supabaseClient=E(tt)}async createProperty(r){return this.supabaseClient.from(Ce).insert({name:r.name,address:r.address,rent:r.rent,mortgage:r.mortgage,user_id:r.userId}).select().single()}async updateProperty(r){return this.supabaseClient.from(Ce).update({name:r.name,address:r.address,rent:r.rent,mortgage:r.mortgage,user_id:r.userId,created_at:r.createdAt,updated_at:r.updatedAt}).eq("id",r.id)}async readProperty(r){return this.supabaseClient.from(Ce).select().eq("id",r).single()}async readProperties(){return this.supabaseClient.from(Ce).select()}async deleteProperty(r){return this.supabaseClient.from(Ce).delete().eq("id",r)}};i.\u0275fac=function(n){return new(n||i)},i.\u0275prov=fe({token:i,factory:i.\u0275fac,providedIn:"root"});let t=i;return t})();a();var Gt=(()=>{let i=class i{createForm(r={name:"",address:"",rent:"0",mortgage:"0",userId:""}){return new ot({name:new Se(r.name,{validators:[be.required],nonNullable:!0}),address:new Se(r.address,{validators:[be.required],nonNullable:!0}),rent:new Se(r.rent,{validators:[be.required],nonNullable:!0}),mortgage:new Se(r.mortgage,{validators:[be.required],nonNullable:!0})})}};i.\u0275fac=function(n){return new(n||i)},i.\u0275prov=fe({token:i,factory:i.\u0275fac});let t=i;return t})();function Hi(t,i){t&1&&T(0,"span",19)}var Zt=(()=>{let i=class i{constructor(){this.propertyFormFactory=E(Gt),this.propertyDataService=E(Oe),this.sessionStore=E(ir),this.router=E($e),this.activatedRoute=E(Ne),this.isLoading=X(!1),this.pageActionTitle=X("Property Creation"),this.actionTitle=X("Create"),this.property=this.activatedRoute.snapshot.data.property,this.createPropertyForm=this.propertyFormFactory.createForm(this.property),this.property&&(this.pageActionTitle.set("Property Update"),this.actionTitle.set("Update"))}async createProperty(){if(this.createPropertyForm.valid)try{if(this.isLoading.set(!0),this.property){let{error:r}=await this.propertyDataService.updateProperty({id:this.property.id,name:this.createPropertyForm.controls.name.value,address:this.createPropertyForm.controls.address.value,rent:this.createPropertyForm.controls.rent.value,mortgage:this.createPropertyForm.controls.mortgage.value,userId:this.sessionStore.getSession().user.id,createdAt:new Date,updatedAt:new Date});r&&console.error(r),this.router.navigate(["properties"])}else{let{data:r,error:n}=await this.propertyDataService.createProperty({name:this.createPropertyForm.controls.name.value,address:this.createPropertyForm.controls.address.value,rent:this.createPropertyForm.controls.rent.value,mortgage:this.createPropertyForm.controls.mortgage.value,userId:this.sessionStore.getSession().user.id});n&&console.error(n),r&&this.router.navigate(["properties","detail",r.id])}}catch(r){r instanceof Error&&console.error(r),this.isLoading.set(!1)}finally{this.isLoading.set(!1)}}};i.\u0275fac=function(n){return new(n||i)},i.\u0275cmp=he({type:i,selectors:[["propertea-property-create-update"]],standalone:!0,features:[et([Gt]),ye],decls:33,vars:4,consts:[[1,"text-5xl","font-bold"],[1,"flex","flex-col","items-center",3,"submit","formGroup"],["for","name",1,"form-control","w-full","max-w-xs"],[1,"label"],[1,"label-text"],["formControlName","name","id","name","type","text","required","required",1,"input","input-bordered","w-full","max-w-xs"],["for","address",1,"form-control","w-full","max-w-xl","mt-4"],[1,"input","input-bordered","flex","items-center","gap-2","w-full","max-w-xl"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke-width","1.5","stroke","currentColor",1,"h-5","w-5","opacity-70"],["stroke-linecap","round","stroke-linejoin","round","d","M15 10.5a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"],["stroke-linecap","round","stroke-linejoin","round","d","M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1 1 15 0Z"],["formControlName","address","id","address","type","text","required","required",1,"grow"],["for","rent",1,"form-control","w-full","max-w-xs","mt-4"],["formControlName","rent","id","rent","type","number","required","required",1,"input","input-bordered","w-full","max-w-xs"],["for","mortgage",1,"form-control","w-full","max-w-xs","mt-4"],["formControlName","mortgage","id","mortgage","type","number","required","required",1,"input","input-bordered","w-full","max-w-xs"],[1,"flex","gap-4","mt-4"],["routerLink","/properties",1,"btn","btn-error"],["type","submit",1,"btn","btn-success"],[1,"loading","loading-spinner"]],template:function(n,o){n&1&&(f(0,"h1",0),v(1),h(),f(2,"form",1),oe("submit",function(){return o.createProperty()}),f(3,"label",2)(4,"div",3)(5,"span",4),v(6,"Name"),h()(),T(7,"input",5),h(),f(8,"label",6)(9,"div",3)(10,"span",4),v(11,"Address"),h()(),f(12,"div",7),K(),f(13,"svg",8),T(14,"path",9)(15,"path",10),h(),G(),T(16,"input",11),h()(),f(17,"label",12)(18,"div",3)(19,"span",4),v(20,"Rent"),h()(),T(21,"input",13),h(),f(22,"label",14)(23,"div",3)(24,"span",4),v(25,"Mortgage"),h()(),T(26,"input",15),h(),f(27,"div",16)(28,"a",17),v(29,"Cancel"),h(),f(30,"button",18),le(31,Hi,1,0,"span",19),v(32),h()()()),n&2&&(x(),ce(o.pageActionTitle()),x(),J("formGroup",o.createPropertyForm),x(29),ne(o.isLoading()?31:-1),x(),re(" ",o.actionTitle()," "))},dependencies:[we,ct,st,rt,nr,it,nt,ut,at,lt],styles:[".property-image[_ngcontent-%COMP%]{height:150px;width:300px}"],changeDetection:0});let t=i;return t})();a();var Wi=(t,i)=>i.id,di=()=>[],Gi=t=>["/properties","detail",t,"expense-create"],Zi=(t,i)=>["/properties","detail",t,"expense-edit",i];function Yi(t,i){if(t&1&&(f(0,"div",6)(1,"p"),v(2),h(),f(3,"p"),v(4),h(),f(5,"p"),v(6),h(),f(7,"p"),v(8),h()()),t&2){let e=ge();x(2),re("Rent: ",e.property.rent,"$"),x(2),re("Mortgage: ",e.property.mortgage,"$"),x(2),re("Total expenses: ",e.totalExpense(),"$"),x(2),re("Result every month: ",e.toPayEveryMonth(),"$")}}function Xi(t,i){if(t&1){let e=Xe();f(0,"tr")(1,"td"),v(2),h(),f(3,"td"),v(4),h(),f(5,"td")(6,"ul",13)(7,"li")(8,"button",14),oe("click",function(){let n=We(e).$implicit,o=ge(2);return Ge(o.deleteExpense(n.id))}),K(),f(9,"svg",15),T(10,"path",16),h()()(),G(),f(11,"li")(12,"a",17),K(),f(13,"svg",18),T(14,"path",19),h()()()()()()}if(t&2){let e=i.$implicit,r=ge(2);x(2),ce(e.name),x(2),re("",e.amount,"$"),x(4),ue("data-tip","Delete expense '"+e.name+"'"),x(4),J("routerLink",tr(5,Zi,r.property.id,e.id)),ue("data-tip","Edit expense '"+e.name+"'")}}function en(t,i){t&1&&(f(0,"tr")(1,"td",20),v(2,"No expenses."),h()())}function tn(t,i){if(t&1&&(f(0,"div",6)(1,"a",9),K(),f(2,"svg",10),T(3,"path",11),h(),v(4," Add an expense "),h(),G(),f(5,"table",12)(6,"thead")(7,"tr")(8,"td"),v(9,"Name"),h(),f(10,"td"),v(11,"Amount"),h(),T(12,"th"),h()(),f(13,"tbody"),Ze(14,Xi,15,8,"tr",null,Wi,!1,en,3,0,"tr"),h()()()),t&2){let e=ge();x(),J("routerLink",me(2,Gi,e.property.id)),x(13),Ye(e.expenses())}}var Je=function(t){return t.Overview="overview",t.Expenses="expenses",t}(Je||{}),pi=(()=>{let i=class i{constructor(){if(this.activatedRoute=E(Ne),this.expensesDataService=E(St),this.isLoading=X(!0),this.expenses=X([]),this.totalExpense=Tt(()=>this.expenses().reduce((r,{amount:n})=>r+parseFloat(n),0)),this.toPayEveryMonth=Tt(()=>{let r=this.totalExpense()+parseFloat(this.property.mortgage),n=parseFloat(this.property.rent);return r>n?"-"+(r-n).toString():"+"+(n-r).toString()}),this.tabTypes=Je,this.activeTab=this.tabTypes.Overview,this.property=this.activatedRoute.snapshot.data.property,this.activatedRoute.snapshot.fragment)switch(this.activatedRoute.snapshot.fragment){case Je.Expenses:this.activeTab=Je.Expenses;break;default:this.activeTab=Je.Overview}}async ngOnInit(){await this.refreshExpenses()}async refreshExpenses(){try{let{data:r,error:n,status:o}=await this.expensesDataService.readExpenses(this.property.id);n&&console.error(n,o),r&&this.expenses.set(r)}catch(r){r instanceof Error&&console.error(r),this.isLoading.set(!1)}finally{this.isLoading.set(!1)}}async deleteExpense(r){try{await this.expensesDataService.deleteExpense(r),await this.refreshExpenses()}catch(n){n instanceof Error&&console.error(n)}}activateTab(r){this.activeTab=r}};i.\u0275fac=function(n){return new(n||i)},i.\u0275cmp=he({type:i,selectors:[["propertea-property-detail"]],standalone:!0,features:[ye],decls:17,vars:16,consts:[[1,"flex"],[1,"text-5xl","font-bold"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24","fill","currentColor",1,"size-6"],["fill-rule","evenodd","d","m11.54 22.351.07.04.028.016a.76.76 0 0 0 .723 0l.028-.015.071-.041a16.975 16.975 0 0 0 1.144-.742 19.58 19.58 0 0 0 2.683-2.282c1.944-1.99 3.963-4.98 3.963-8.827a8.25 8.25 0 0 0-16.5 0c0 3.846 2.02 6.837 3.963 8.827a19.58 19.58 0 0 0 2.682 2.282 16.975 16.975 0 0 0 1.145.742ZM12 13.5a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z","clip-rule","evenodd"],["role","tablist",1,"tabs","tabs-bordered","mt-4"],["role","tab",1,"tab",3,"click","routerLink","relativeTo"],[1,"tab-content","p-4"],["role","tab",1,"indicator","tab",3,"click","routerLink","relativeTo","fragment"],[1,"indicator-item","badge","badge-accent"],[1,"btn",3,"routerLink"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke-width","1.5","stroke","currentColor",1,"h-6","w-6"],["stroke-linecap","round","stroke-linejoin","round","d","M12 4.5v15m7.5-7.5h-15"],[1,"table"],[1,"menu","menu-horizontal","bg-base-200","rounded-box"],["type","button",1,"tooltip",3,"click"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke-width","1.5","stroke","currentColor",1,"h-5","w-5","text-error"],["stroke-linecap","round","stroke-linejoin","round","d","m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"],[1,"tooltip",3,"routerLink"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke-width","1.5","stroke","currentColor",1,"h-5","w-5"],["stroke-linecap","round","stroke-linejoin","round","d","m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"],["colspan","2"]],template:function(n,o){n&1&&(f(0,"header",0)(1,"h1",1),v(2),h()(),f(3,"p",0),K(),f(4,"svg",2),T(5,"path",3),h(),G(),f(6,"span"),v(7),h()(),f(8,"div",4)(9,"a",5),oe("click",function(){return o.activateTab(o.tabTypes.Overview)}),v(10,"Overview"),h(),le(11,Yi,9,4,"div",6),f(12,"a",7),oe("click",function(){return o.activateTab(o.tabTypes.Expenses)}),v(13," Expenses "),f(14,"span",8),v(15),h()(),le(16,tn,17,4,"div",6),h()),n&2&&(x(2),ce(o.property.name),x(5),ce(o.property.address),x(2),Pt("tab-active",o.activeTab===o.tabTypes.Overview),J("routerLink",Ct(14,di))("relativeTo",o.activatedRoute),x(2),ne(o.activeTab===o.tabTypes.Overview?11:-1),x(),Pt("tab-active",o.activeTab===o.tabTypes.Expenses),J("routerLink",Ct(15,di))("relativeTo",o.activatedRoute)("fragment",o.tabTypes.Expenses),x(3),ce(o.expenses().length),x(),ne(o.activeTab===o.tabTypes.Expenses?16:-1))},dependencies:[we],styles:[".property-image[_ngcontent-%COMP%]{height:150px;width:300px}"],changeDetection:0});let t=i;return t})();a();var rn=(t,i)=>i.id,Yt=t=>["/properties","detail",t],nn=t=>["/properties","update",t];function on(t,i){t&1&&(f(0,"div",6)(1,"figure"),T(2,"div",7),h(),f(3,"div",8),T(4,"div",9)(5,"div",10),h()())}function sn(t,i){if(t&1){let e=Xe();f(0,"div",6)(1,"figure"),T(2,"img",12),h(),f(3,"div",13)(4,"div")(5,"h2",14)(6,"a",15),v(7),h()(),f(8,"p",0),K(),f(9,"svg",16),T(10,"path",17),h(),G(),f(11,"span"),v(12),h()(),f(13,"p",0)(14,"span"),v(15),h()(),f(16,"p",0)(17,"span"),v(18),h()()(),f(19,"ul",18)(20,"li")(21,"a",19),K(),f(22,"svg",20),T(23,"path",21),h()()(),G(),f(24,"li")(25,"a",22),K(),f(26,"svg",20),T(27,"path",23),h()()(),G(),f(28,"li")(29,"a",19),K(),f(30,"svg",20),T(31,"path",24),h()()(),G(),f(32,"li")(33,"button",25),oe("click",function(){let n=We(e).$implicit,o=ge(2);return Ge(o.deleteProperty(n.id))}),K(),f(34,"svg",26),T(35,"path",27),h()()()()()()}if(t&2){let e=i.$implicit;x(6),J("routerLink",me(13,Yt,e.id)),ue("title","Inspect property '"+e.name+"'"),x(),re(" ",e.name," "),x(5),ce(e.address),x(3),re("rent: ",e.rent,"$"),x(3),re("mortgage: ",e.mortgage,"$"),x(3),J("routerLink",me(15,Yt,e.id)),ue("data-tip","Inspect property '"+e.name+"'"),x(4),J("routerLink",me(17,Yt,e.id)),ue("data-tip","Manage expenses for property '"+e.name+"'"),x(4),J("routerLink",me(19,nn,e.id)),ue("data-tip","Edit property '"+e.name+"'"),x(4),ue("data-tip","Delete property '"+e.name+"'")}}function an(t,i){t&1&&(f(0,"div",11)(1,"div",28)(2,"p"),v(3,"No properties found."),h(),f(4,"p")(5,"a",29),v(6,"Add"),h(),v(7," your properties to start managing them."),h()()())}function ln(t,i){if(t&1&&Ze(0,sn,36,21,"div",6,rn,!1,an,8,0,"div",11),t&2){let e=ge();Ye(e.properties())}}var fi=(()=>{let i=class i{constructor(){this.propertyDataService=E(Oe),this.isLoading=X(!0),this.properties=X([])}ngOnInit(){this.refreshProperties()}async refreshProperties(){try{let{data:r,error:n,status:o}=await this.propertyDataService.readProperties();n&&console.error(n,o),r&&this.properties.set(r)}catch(r){r instanceof Error&&console.error(r),this.isLoading.set(!1)}finally{this.isLoading.set(!1)}}async deleteProperty(r){try{await this.propertyDataService.deleteProperty(r),await this.refreshProperties()}catch(n){n instanceof Error&&console.error(n)}}};i.\u0275fac=function(n){return new(n||i)},i.\u0275cmp=he({type:i,selectors:[["propertea-property-list"]],standalone:!0,features:[ye],decls:9,vars:2,consts:[[1,"flex"],[1,"text-5xl","font-bold"],["routerLink","/properties/create",1,"btn","btn-square","ml-4"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke-width","1.5","stroke","currentColor",1,"size-8"],["stroke-linecap","round","stroke-linejoin","round","d","M12 4.5v15m7.5-7.5h-15"],[1,"flex","flex-col","gap-4","mt-4"],[1,"card","card-side","bg-base-100","shadow-xl","py-4"],[1,"skeleton",2,"height","150px","width","300px"],[1,"card-body"],[1,"card-title","skeleton","h-4","w-28"],[1,"skeleton","h-4","w-full"],[1,"card","card-side","bg-base-100","shadow-xl","py-4","mt-6","border-2","border-accent-content","border-dashed"],["src","https://placehold.co/300x150","alt","Movie","width","300","height","150",1,"property-image","object-fill","rounded-box"],[1,"card-body","flex-row","justify-between"],[1,"card-title"],[1,"link","link-hover",3,"routerLink"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24","fill","currentColor",1,"size-6"],["fill-rule","evenodd","d","m11.54 22.351.07.04.028.016a.76.76 0 0 0 .723 0l.028-.015.071-.041a16.975 16.975 0 0 0 1.144-.742 19.58 19.58 0 0 0 2.683-2.282c1.944-1.99 3.963-4.98 3.963-8.827a8.25 8.25 0 0 0-16.5 0c0 3.846 2.02 6.837 3.963 8.827a19.58 19.58 0 0 0 2.682 2.282 16.975 16.975 0 0 0 1.145.742ZM12 13.5a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z","clip-rule","evenodd"],[1,"menu","menu-horizontal","bg-base-200","rounded-box","self-center"],[1,"tooltip",3,"routerLink"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke-width","1.5","stroke","currentColor",1,"h-5","w-5"],["stroke-linecap","round","stroke-linejoin","round","d","m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"],["fragment","expenses",1,"tooltip",3,"routerLink"],["stroke-linecap","round","stroke-linejoin","round","d","M12 6v12m-3-2.818.879.659c1.171.879 3.07.879 4.242 0 1.172-.879 1.172-2.303 0-3.182C13.536 12.219 12.768 12 12 12c-.725 0-1.45-.22-2.003-.659-1.106-.879-1.106-2.303 0-3.182s2.9-.879 4.006 0l.415.33M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"],["stroke-linecap","round","stroke-linejoin","round","d","m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"],["type","button",1,"tooltip",3,"click"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke-width","1.5","stroke","currentColor",1,"h-5","w-5","text-error"],["stroke-linecap","round","stroke-linejoin","round","d","m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"],[1,"card-body","items-center"],["routerLink","/properties/create",1,"link","link-primary"]],template:function(n,o){n&1&&(f(0,"header",0)(1,"h1",1),v(2,"My Properties"),h(),f(3,"a",2),K(),f(4,"svg",3),T(5,"path",4),h()()(),G(),f(6,"div",5),le(7,on,6,0,"div",6)(8,ln,3,1),h()),n&2&&(x(7),ne(o.isLoading()?7:-1),x(),ne(o.isLoading()?-1:8))},dependencies:[we],styles:[".property-image[_ngcontent-%COMP%]{height:150px;width:300px}"],changeDetection:0});let t=i;return t})();a();var un=async t=>{let i=t.paramMap.get("propertyId"),e=new rr(E($e).parseUrl("/"),{skipLocationChange:!0});if(!i)return e;let{data:r}=await E(Oe).readProperty(i);return r||e},Xt=un;var cn=[{path:"",component:fi},{path:"create",component:Zt},{path:"update/:propertyId",component:Zt,resolve:{property:Xt}},{path:"detail/:propertyId",component:pi,resolve:{property:Xt}},{path:"detail/:propertyId/expense-create",component:mi}],wu=cn;export{wu as default};
